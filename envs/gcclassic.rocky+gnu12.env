#==============================================================================
# gcclassic.rocky+gnu12.env
#
# Environment file for GEOS-Chem Classic, on Rocky Linux with
# GNU Compiler Collection 12.2.0
#==============================================================================

# Print if interactive shell
if [[ $- = *i* ]] ; then
  echo "Loading modules for GEOS-Chem, please wait ..."
fi

#==============================================================================
# Modules (specific to compute cluster)
#==============================================================================

module purge
module load gcc/12.2.0-fasrc01
module load openmpi/4.1.4-fasrc01
module load netcdf-fortran/4.6.0-fasrc02
module load flex/2.6.4-fasrc01
module load cmake/3.25.2-fasrc01

#==============================================================================
# Environment variables
#==============================================================================

# For GEOS-Chem Classic use
export OMP_NUM_THREADS=8
export OMP_STACKSIZE=500m

# Make all files world-readable by default
umask 022

# Specify compiler
export FC=gfortran

# Netcdf variables for CMake
export NetCDF_C_ROOT=${NETCDF_HOME}
export NETCDF_FORTRAN_ROOT=${NETCDF_FORTRAN_HOME}

#
export KPP_FLEX_LIB_DIR=${FLEX_HOME}/lib64

# Raise memory limits
ulimit -c unlimited              # coredumpsize
ulimit -l unlimited              # memorylocked
ulimit -u 50000                  # maxproc
ulimit -v unlimited              # vmemoryuse
ulimit -s unlimited              # stacksize

# List modules loaded
module list


